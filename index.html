<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ù„Ù‰ Ù…Ù„ÙƒØªÙŠ Ù†Ø¯Ù‰ â¤ï¸</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@700&family=Amiri:wght@700&display=swap');
        :root { --pink: #ff69b4; --dark-red: #800e13; --gold: #ffd700; }
        
        /* Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© */
        body { 
            margin: 0; 
            background-color: #fff0f3; 
            background-size: cover; 
            background-position: center; 
            background-attachment: fixed;
            font-family: 'Cairo', sans-serif; 
            color: var(--dark-red); 
            text-align: center;
            transition: background 0.5s ease-in-out;
        }

        #gate { height: 100vh; background: #000; color: var(--gold); display: flex; flex-direction: column; justify-content: center; align-items: center; position: fixed; width: 100%; z-index: 2000; transition: 1s; }
        .gate-title { font-family: 'Amiri', serif; font-size: 4rem; margin-bottom: 20px; }
        
        #content { display: none; padding: 20px; opacity: 0; transition: 1s; background: rgba(255, 240, 243, 0.8); min-height: 100vh; }
        .hero-title { font-family: 'Amiri', serif; font-size: 3rem; margin: 20px 0; }
        
        .msg-section { background: rgba(255, 255, 255, 0.9); padding: 20px; border-radius: 15px; max-width: 800px; margin: 20px auto; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .msg-card { border-right: 5px solid var(--pink); padding: 15px; margin: 10px 0; text-align: right; background: #fff9fa; border-radius: 5px; font-size: 1.1rem; }

        .gallery { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 10px; max-width: 900px; margin: auto; }
        .gallery img { width: 100%; height: 200px; object-fit: cover; border-radius: 10px; border: 3px solid white; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }

        #lightbox { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 5000; justify-content: center; align-items: center; }
        #lightbox img { max-width: 95%; max-height: 85%; border-radius: 10px; }
        #close-light { position: absolute; top: 20px; right: 20px; color: white; font-size: 40px; cursor: pointer; }

        .v-list { max-width: 850px; margin: 20px auto; }
        .v-item { border: 5px solid white; border-radius: 15px; overflow: hidden; margin-bottom: 20px; background: #000; }

        #admin-panel { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 20px; box-shadow: 0 0 100px rgba(0,0,0,0.5); z-index: 3000; width: 330px; border: 3px solid var(--pink); max-height: 90vh; overflow-y: auto; }
        .adm-input { width: 90%; padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 8px; }
        .adm-btn { width: 100%; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; background: var(--pink); color: white; margin-top: 5px; }
    </style>
</head>
<body>

    <div id="gate">
        <div class="gate-title">NADA</div>
        <input type="text" id="nadaPass" placeholder="ØªØ§Ø±ÙŠØ®Ù†Ø§ Ø§Ù„Ø³Ø±ÙŠ (27/11)">
        <button onclick="unlock()" style="margin-top:20px; background:var(--gold); border:none; padding:12px 40px; border-radius:30px; cursor:pointer;">Ø¯Ø®ÙˆÙ„</button>
    </div>

    <div id="lightbox" onclick="this.style.display='none'">
        <span id="close-light">&times;</span>
        <img id="light-img" src="">
    </div>

    <div id="content">
        <h1 class="hero-title">Ø¨Ø­Ø¨Ùƒ ÙŠØ§ Ù†Ø¯Ù‰ â¤ï¸</h1>
        <div id="timer" style="font-weight: bold; margin-bottom: 20px; font-size: 1.3rem;"></div>

        <div class="msg-section" id="messages-area">
            <h3>Ø±Ø³Ø§Ø¦Ù„ Ù…Ù† Ù‚Ù„Ø¨ÙŠ ğŸ’Œ</h3>
            <div id="messages-list"></div>
        </div>
        
        <h3 style="margin-top: 40px;">Ø°ÙƒØ±ÙŠØ§ØªÙ†Ø§ Ø§Ù„Ø¬Ù…ÙŠÙ„Ø© ğŸ“¸</h3>
        <div class="gallery" id="photo-gallery"></div>

        <h3 style="margin-top: 40px;">ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù„Ù†Ø§ ğŸ¥</h3>
        <div class="v-list" id="video-list"></div>
        
        <footer style="padding: 50px; opacity: 0.8; font-weight: bold;">Ø­ÙƒØ§ÙŠØªÙ†Ø§ Ù…Ø³ØªÙ…Ø±Ø©.. â¤ï¸</footer>
    </div>

    <div onclick="openAdmin()" style="position:fixed; bottom:15px; right:15px; cursor:pointer; opacity:0.1; font-size: 30px; z-index: 4000;">â¤ï¸</div>

    <div id="admin-panel">
        <h3 style="color: var(--pink); margin-top: 0;">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ù„Ùƒ ğŸ‘‘</h3>
        
        <label>Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø© Ù„Ù„Ø°ÙƒØ±ÙŠØ§Øª:</label>
        <input type="file" id="fileInp" class="adm-input" accept="image/*">
        
        <label style="color: blue; font-weight: bold;">ğŸ–¼ï¸ ØªØºÙŠÙŠØ± Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…ÙˆÙ‚Ø¹:</label>
        <input type="file" id="bgFileInp" class="adm-input" accept="image/*">
        
        <label>Ø¥Ø¶Ø§ÙØ© Ø±Ø³Ø§Ù„Ø© Ø­Ø¨:</label>
        <textarea id="msgInp" class="adm-input" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ..."></textarea>
        
        <label>Ø¥Ø¶Ø§ÙØ© Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ ÙŠÙˆØªÙŠÙˆØ¨:</label>
        <input type="text" id="ytInp" class="adm-input" placeholder="Ø±Ø§Ø¨Ø· ÙŠÙˆØªÙŠÙˆØ¨">
        
        <button onclick="uploadAction()" id="upBtn" class="adm-btn">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
        <div id="status" style="font-size: 11px; margin-top: 5px; color: blue;"></div>
        
        <hr>
        <div id="admin-items" style="font-size: 12px; text-align: right;"></div>
        <button onclick="document.getElementById('admin-panel').style.display='none'" class="adm-btn" style="background:#ccc; color:#333;">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyD5ur978leN7LJLyRVtEeHkilJ30K1xV0w",
            authDomain: "nody-2711.firebaseapp.com",
            projectId: "nody-2711",
            databaseURL: "https://nody-2711-default-rtdb.firebaseio.com/"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function unlock() {
            if(document.getElementById('nadaPass').value === "27/11") {
                document.getElementById('gate').style.top = "-100vh";
                document.getElementById('content').style.display = "block";
                setTimeout(() => document.getElementById('content').style.opacity = "1", 500);
                startTimer(); loadData();
            } else { alert("Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯ ØºÙ„Ø·!"); }
        }

        function openAdmin() {
            if(prompt("ÙƒÙ„Ù…Ø© Ø³Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:") === "1997") {
                document.getElementById('admin-panel').style.display = "block";
                loadAdminList();
            }
        }

        async function uploadAction() {
            const file = document.getElementById('fileInp').files[0];
            const bgFile = document.getElementById('bgFileInp').files[0];
            const msg = document.getElementById('msgInp').value;
            const yt = document.getElementById('ytInp').value;
            const btn = document.getElementById('upBtn');
            const status = document.getElementById('status');

            btn.disabled = true;
            status.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¯ÙŠØ«...";

            if(yt) await db.ref('videos').push({url: yt});
            if(msg) await db.ref('messages').push({text: msg});

            // Ø±ÙØ¹ Ø§Ù„Ø®Ù„ÙÙŠØ© Ù…Ù† Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„
            if(bgFile) {
                const reader = new FileReader();
                reader.readAsDataURL(bgFile);
                reader.onload = async function() {
                    await db.ref('settings/background').set(reader.result);
                };
            }

            // Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ø°ÙƒØ±ÙŠØ§Øª
            if(file) {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = async function() {
                    await db.ref('photos').push({url: reader.result, name: file.name});
                    finishUpdate();
                };
            } else { 
                setTimeout(finishUpdate, 1500); 
            }
        }

        function finishUpdate() {
            document.getElementById('upBtn').disabled = false;
            document.getElementById('status').innerText = "ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¨Ù†Ø¬Ø§Ø­!";
            document.getElementById('msgInp').value = "";
            document.getElementById('ytInp').value = "";
            document.getElementById('fileInp').value = "";
            document.getElementById('bgFileInp').value = "";
            loadAdminList();
        }

        function loadData() {
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø®Ù„ÙÙŠØ© Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø©
            db.ref('settings/background').on('value', s => {
                if(s.val()) document.body.style.backgroundImage = `url(${s.val()})`;
            });
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
            db.ref('messages').on('value', s => {
                const list = document.getElementById('messages-list'); list.innerHTML = "";
                if(s.val()) Object.values(s.val()).reverse().forEach(m => {
                    list.innerHTML += `<div class="msg-card">${m.text}</div>`;
                });
            });
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±
            db.ref('photos').on('value', s => {
                const g = document.getElementById('photo-gallery'); g.innerHTML = "";
                if(s.val()) Object.values(s.val()).forEach(p => {
                    g.innerHTML += `<img src="${p.url}" onclick="showFull('${p.url}')">`;
                });
            });
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª
            db.ref('videos').on('value', s => {
                const v = document.getElementById('video-list'); v.innerHTML = "";
                if(s.val()) Object.values(s.val()).reverse().forEach(vid => {
                    let id = vid.url.includes('v=') ? vid.url.split('v=')[1].split('&')[0] : vid.url.split('/').pop();
                    v.innerHTML += `<div class="v-item"><iframe width="100%" height="300" src="https://www.youtube.com/embed/${id}" frameborder="0" allowfullscreen></iframe></div>`;
                });
            });
        }

        function showFull(url) {
            document.getElementById('light-img').src = url;
            document.getElementById('lightbox').style.display = "flex";
        }

        function loadAdminList() {
            const list = document.getElementById('admin-items'); list.innerHTML = "<b>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¹Ù†Ø§ØµØ±:</b><br>";
            ['photos', 'messages', 'videos'].forEach(t => {
                db.ref(t).once('value', s => {
                    if(s.val()) Object.keys(s.val()).forEach(k => {
                        list.innerHTML += `<div>${t}: <button onclick="del('${t}','${k}')" style="color:red; border:none; background:none; cursor:pointer;">Ø­Ø°Ù</button></div>`;
                    });
                });
            });
        }

        async function del(path, key) {
            if(confirm("Ø­Ø°ÙØŸ")) { await db.ref(`${path}/${key}`).remove(); loadAdminList(); }
        }

        function startTimer() {
            const start = new Date("November 27, 2022 00:00:00").getTime();
            setInterval(() => {
                const d = Math.floor((new Date().getTime() - start) / (1000 * 60 * 60 * 24));
                document.getElementById('timer').innerText = `Ø¨Ù‚Ø§Ù„Ù†Ø§ ${d} ÙŠÙˆÙ… Ø³ÙˆØ§ â¤ï¸`;
            }, 1000);
        }
    </script>
</body>
</html>
